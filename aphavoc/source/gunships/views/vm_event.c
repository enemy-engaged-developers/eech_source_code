//
// 	 Enemy Engaged RAH-66 Comanche Versus KA-52 Hokum
// 	 Copyright (C) 2000 Empire Interactive (Europe) Ltd,
// 	 677 High Road, North Finchley, London N12 0DA
//
// 	 Please see the document LICENSE.TXT for the full licence agreement
//
// 2. LICENCE
//  2.1
//  	Subject to the provisions of this Agreement we now grant to you the
//  	following rights in respect of the Source Code:
//   2.1.1
//   	the non-exclusive right to Exploit  the Source Code and Executable
//   	Code on any medium; and
//   2.1.2
//   	the non-exclusive right to create and distribute Derivative Works.
//  2.2
//  	Subject to the provisions of this Agreement we now grant you the
// 	following rights in respect of the Object Code:
//   2.2.1
// 	the non-exclusive right to Exploit the Object Code on the same
// 	terms and conditions set out in clause 3, provided that any
// 	distribution is done so on the terms of this Agreement and is
// 	accompanied by the Source Code and Executable Code (as
// 	applicable).
//
// 3. GENERAL OBLIGATIONS
//  3.1
//  	In consideration of the licence granted in clause 2.1 you now agree:
//   3.1.1
// 	that when you distribute the Source Code or Executable Code or
// 	any Derivative Works to Recipients you will also include the
// 	terms of this Agreement;
//   3.1.2
// 	that when you make the Source Code, Executable Code or any
// 	Derivative Works ("Materials") available to download, you will
// 	ensure that Recipients must accept the terms of this Agreement
// 	before being allowed to download such Materials;
//   3.1.3
// 	that by Exploiting the Source Code or Executable Code you may
// 	not impose any further restrictions on a Recipient's subsequent
// 	Exploitation of the Source Code or Executable Code other than
// 	those contained in the terms and conditions of this Agreement;
//   3.1.4
// 	not (and not to allow any third party) to profit or make any
// 	charge for the Source Code, or Executable Code, any
// 	Exploitation of the Source Code or Executable Code, or for any
// 	Derivative Works;
//   3.1.5
// 	not to place any restrictions on the operability of the Source
// 	Code;
//   3.1.6
// 	to attach prominent notices to any Derivative Works stating
// 	that you have changed the Source Code or Executable Code and to
// 	include the details anddate of such change; and
//   3.1.7
//   	not to Exploit the Source Code or Executable Code otherwise than
// 	as expressly permitted by  this Agreement.
//



////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#include "project.h"

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int
   move_view_left_key,
   move_view_right_key,
   move_view_forward_key,
   move_view_backward_key,
   increase_fov_key_down,
   decrease_fov_key_down,
   adjust_view_left_key,
   adjust_view_right_key,
   adjust_view_up_key,
   adjust_view_down_key,
	adjust_view_zoom_in_key,
	adjust_view_zoom_out_key;

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

int
	joystick_pov_engage,
	joystick_pov_disengage,
	joystick_pov_centred,
	joystick_pov_left,
	joystick_pov_right,
	joystick_pov_up,
	joystick_pov_down;

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#define STATIC (0)
#define LEFT   (-1)
#define RIGHT  (1)
#define UP     (-1)
#define DOWN   (1)

#define DEFAULT_FOV 60.0

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// INITIALISE
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void initialise_view_events (void)
{
   adjust_view_left_key = FALSE;

   adjust_view_right_key = FALSE;

   adjust_view_up_key = FALSE;

   adjust_view_down_key = FALSE;

	adjust_view_zoom_in_key = FALSE;

	adjust_view_zoom_out_key = FALSE;

	joystick_pov_engage = FALSE;

	joystick_pov_disengage = FALSE;

	joystick_pov_centred = TRUE;

	joystick_pov_left = FALSE;

	joystick_pov_right = FALSE;

	joystick_pov_up = FALSE;

	joystick_pov_down = FALSE;

//VJ 030318 wideview mod
  	edit_wide_cockpit = FALSE;
	set_global_wide_cockpit (FALSE);

//VJ 030511 TSD render mod, linked to eech.ini
	tsd_render_mode = (tsd_render_modes) (command_line_tsd_render_mode + 1);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// SPECIAL VIEWS
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void set_special1_view_mode (void)
{
	switch (get_global_gunship_type ())
	{
		////////////////////////////////////////
		// JB 030313 Fly any aircraft
		default:
		case GUNSHIP_TYPE_APACHE:
		////////////////////////////////////////
		{
			//VJ 050301 add this to prevent crash when in 3D cockpit
			if (command_line_3d_cockpit)
				break;
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_LHS_MFD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_LHS_MFD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_HAVOC:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_TV)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_TV);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_COMANCHE:
		////////////////////////////////////////
		{
			if (get_crew_role () == CREW_ROLE_PILOT)
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}
			else
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_LHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_LHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_HOKUM:
		////////////////////////////////////////
		{
			if (get_crew_role () == CREW_ROLE_PILOT)
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}
			else
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_LHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_LHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}

			break;
		}
		////Moje 030518 Start
		case GUNSHIP_TYPE_BLACKHAWK:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_LHS_MFD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_LHS_MFD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////Moje 030518 End
		////Moje 030612 start
		////////////////////////////////////////
		case GUNSHIP_TYPE_HIND:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_HUD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_HUD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////Moje 030612 end
		////Moje 030816 Start
		case GUNSHIP_TYPE_AH64A:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_LHS_MFD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_LHS_MFD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_KA50:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY)
			{
				set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////Moje 030816 end
		////////////////////////////////////////
		case GUNSHIP_TYPE_VIPER:
		////////////////////////////////////////
		case GUNSHIP_TYPE_KIOWA:
		////////////////////////////////////////
		{
			if (get_crew_role () == CREW_ROLE_PILOT)
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_LHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}
			else
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_LHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_LHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}

			break;
		}
		////////////////////////////////////////
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void set_special2_view_mode (void)
{
	switch (get_global_gunship_type ())
	{
		////////////////////////////////////////
		// JB 030313 Fly any aircraft
		default:
		case GUNSHIP_TYPE_APACHE:
		////////////////////////////////////////
		{
			//VJ 050301 add this to prevent crash when in 3D cockpit
			if (command_line_3d_cockpit)
				break;
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_RHS_MFD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_RHS_MFD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_HAVOC:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_HUD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_HUD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_COMANCHE:
		////////////////////////////////////////
		{
			if (get_crew_role () == CREW_ROLE_PILOT)
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}
			else
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_RHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_RHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_HOKUM:
		////////////////////////////////////////
		{
			if (get_crew_role () == CREW_ROLE_PILOT)
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}
			else
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_RHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_RHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}

			break;
		}
		////Moje 030518 Start
		case GUNSHIP_TYPE_BLACKHAWK:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_RHS_MFD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_RHS_MFD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////Moje 030518 End
		////Moje 036012 start
		////////////////////////////////////////
		case GUNSHIP_TYPE_HIND:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_TV)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_HAVOC_TV);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
			}

			break;
		}
		////Moje 03061 2end
		////Moje 030816 Start
		case GUNSHIP_TYPE_AH64A:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_RHS_MFD)
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_SPECIAL_APACHE_RHS_MFD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
			}

			break;
		}
		////////////////////////////////////////
		case GUNSHIP_TYPE_KA50:
		////////////////////////////////////////
		{
			if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY)
			{
				set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
			}

			break;
		}
		////Moje 030816 end
		////////////////////////////////////////
		case GUNSHIP_TYPE_VIPER:
		////////////////////////////////////////
		case GUNSHIP_TYPE_KIOWA:
		////////////////////////////////////////
		{
			if (get_crew_role () == CREW_ROLE_PILOT)
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_PILOT_RHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}
			else
			{
				if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_RHS_DISPLAY)
				{
					set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_CO_PILOT_RHS_DISPLAY);
				}
				else
				{
					set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
				}
			}

			break;
		}
		////////////////////////////////////////
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// PAN
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_rel_left_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

	  	set_view_mode (get_rel_fixed_cockpit_view (STATIC, LEFT));
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_rel_right_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

   	set_view_mode (get_rel_fixed_cockpit_view (STATIC, RIGHT));
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_rel_up_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

   	set_view_mode (get_rel_fixed_cockpit_view (UP, STATIC));
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_rel_down_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

  		set_view_mode (get_rel_fixed_cockpit_view (DOWN, STATIC));
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_abs_left_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

   	set_view_mode (get_abs_fixed_cockpit_view (STATIC, LEFT));
	}
	else
	{
		set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_LEFT90);
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_abs_right_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

	   set_view_mode (get_abs_fixed_cockpit_view (STATIC, RIGHT));
	}
	else
	{
		set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_RIGHT90);
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_abs_up_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

   	set_view_mode (get_abs_fixed_cockpit_view (UP, STATIC));
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_abs_down_event (event *ev)
{
	if (get_apache_havoc_gunship ())
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));

	   set_view_mode (get_abs_fixed_cockpit_view (DOWN, STATIC));
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void adjust_view_left_event (event *ev)
{
	if (ev->state == KEY_STATE_DOWN)
	{
		if (in_cockpit)
		{
			set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT);
		}

		adjust_view_left_key = TRUE;
	}
	else
	{
		adjust_view_left_key = FALSE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void adjust_view_right_event (event *ev)
{
	if (ev->state == KEY_STATE_DOWN)
	{
		if (in_cockpit)
		{
			set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT);
		}

		adjust_view_right_key = TRUE;
	}
	else
	{
		adjust_view_right_key = FALSE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void adjust_view_up_event (event *ev)
{
	if (ev->state == KEY_STATE_DOWN)
	{
		if (in_cockpit)
		{
			set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT);
		}

		adjust_view_up_key = TRUE;
	}
	else
	{
		adjust_view_up_key = FALSE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void adjust_view_down_event (event *ev)
{
	if (ev->state == KEY_STATE_DOWN)
	{
		if (in_cockpit)
		{
			set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT);
		}

		adjust_view_down_key = TRUE;
	}
	else
	{
		adjust_view_down_key = FALSE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void move_view_position_left_event (event* ev)
{
	move_view_left_key = (ev->state == KEY_STATE_DOWN);
}

static void move_view_position_right_event (event* ev)
{
	move_view_right_key = (ev->state == KEY_STATE_DOWN);
}

static void move_view_position_forward_event (event* ev)
{
	if (ev->state == KEY_STATE_DOWN)
		if (ev->modifier == MODIFIER_LEFT_SHIFT)
			move_view_forward_key = 3;
		else
			move_view_forward_key = 1;
	else
		move_view_forward_key = 0;
}

static void move_view_position_backward_event (event* ev)
{
	if (ev->state == KEY_STATE_DOWN)
		if (ev->modifier == MODIFIER_LEFT_SHIFT)
			move_view_backward_key = 3;
		else
			move_view_backward_key = 1;
	else
		move_view_backward_key = 0;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void release_virtual_cockpit_event (event *ev)
{
	if (view_mode == VIEW_MODE_VIRTUAL_COCKPIT)
	{
		set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// ZOOM
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void adjust_view_zoom_in_event (event *ev)
{
	if (ev->state == KEY_STATE_DOWN)
	{
		adjust_view_zoom_in_key = TRUE;
	}
	else
	{
		adjust_view_zoom_in_key = FALSE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void adjust_view_zoom_out_event (event *ev)
{
	if (ev->state == KEY_STATE_DOWN)
	{
		adjust_view_zoom_out_key = TRUE;
	}
	else
	{
		adjust_view_zoom_out_key = FALSE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// MAIN COCKPIT VIEWS
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void forward_view_event (event *ev)
{
	set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void instrument_view_event (event *ev)
{
	set_view_mode (VIEW_MODE_COCKPIT_PANEL_DOWN20_AHEAD);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_at_special1_event (event *ev)
{
	set_special1_view_mode ();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void look_at_special2_event (event *ev)
{
	set_special2_view_mode ();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void hud_view_event (event *ev)
{
	if (get_global_gunship_type () == GUNSHIP_TYPE_HOKUM)
	{
		if (get_crew_role () == CREW_ROLE_PILOT)
		{
			if (view_mode != VIEW_MODE_VIRTUAL_COCKPIT_HUD)
			{
				set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_HUD);
			}
			else
			{
				set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
			}
		}
		else
		{
			set_pilot_seat_position ();

			if (get_crew_role () == CREW_ROLE_PILOT)
			{
				set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_HUD);
			}
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void switch_seat_position_event (event *ev)
{
	switch_seat_position ();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#if 0
static void set_pilot_seat_position_event (event *ev)
{
	set_pilot_seat_position ();
}
#endif

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

#if 0
static void set_co_pilot_seat_position_event (event *ev)
{
	set_co_pilot_seat_position ();
}
#endif

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_draw_cockpit_graphics_event (event *ev)
{
	set_global_draw_cockpit_graphics (get_global_draw_cockpit_graphics () ^ 1);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_draw_overlaid_instruments_event (event *ev)
{
	set_global_draw_overlaid_instruments (get_global_draw_overlaid_instruments () ^ 1);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_glass_cockpit_event (event *ev)
{
	if (get_global_draw_cockpit_graphics ())
	{
		set_global_glass_cockpit (get_global_glass_cockpit () ^ 1);
	}
	else
	{
		set_global_draw_overlaid_instruments (get_global_draw_overlaid_instruments () ^ 1);
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_display_hud_on_external_view_event (event *ev)
{
	set_global_display_hud_on_external_view (get_global_display_hud_on_external_view () ^ 1);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_unscaled_displays_event (event *ev)
{
	//set_global_unscaled_displays (get_global_unscaled_displays () ^ 1);
	//VJ 050205, 050210, 060913 hud scaling mod
	global_hud_size2 += 0.1;
	if (global_hud_size2 > 1.41)
		global_hud_size2 = 0.7;

	//VJ 060211 hud_code: store hud info
	hud_code[(int)get_global_gunship_type ()][2] = (int)(global_hud_size2*10)+1;

	set_global_unscaled_displays (global_hud_size2 <= 1.0 ? TRUE : FALSE);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void set_next_mfd_size_event (event *ev)
{
	gunship_types type = get_global_gunship_type();

	if (type >= (sizeof(hud_code) / sizeof(hud_code[0])))
	{
		type = GUNSHIP_TYPE_AH64A;
	}

	global_mfd_size += 0.05;
	if (global_mfd_size >= 1.2)
	{
		global_mfd_size = 0.4;
	}

	hud_code[(int)type][HUD_CODES_MFD] = ( int ) ( global_mfd_size * 20.0 );
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void decrease_cockpit_detail_event (event *ev)
{
	cockpit_detail_levels
		level;

	level = get_global_cockpit_detail_level ();

	if (level == COCKPIT_DETAIL_LEVEL_HIGH)
	{
		level = COCKPIT_DETAIL_LEVEL_MEDIUM;
	}
	else if (level == COCKPIT_DETAIL_LEVEL_MEDIUM)
	{
		level = COCKPIT_DETAIL_LEVEL_LOW;
	}

	set_global_cockpit_detail_level (level);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void increase_cockpit_detail_event (event *ev)
{
	cockpit_detail_levels
		level;

	level = get_global_cockpit_detail_level ();

	if (level == COCKPIT_DETAIL_LEVEL_LOW)
	{
		level = COCKPIT_DETAIL_LEVEL_MEDIUM;
	}
	else if (level == COCKPIT_DETAIL_LEVEL_MEDIUM)
	{
		level = COCKPIT_DETAIL_LEVEL_HIGH;
	}

	set_global_cockpit_detail_level (level);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//VJ 030423 TSD render mod
static void TSD_render_event (event *ev)
{
	switch(tsd_render_mode) {
		case TSD_RENDER_CONTOUR_MODE :
	   	set_TSD_render_mode(TSD_RENDER_CONTOUR_RELIEF_MODE);
	   	break;
		case TSD_RENDER_CONTOUR_RELIEF_MODE :
	   	set_TSD_render_mode(TSD_RENDER_RELIEF_MODE);
	   	break;
		case TSD_RENDER_RELIEF_MODE :
	   	set_TSD_render_mode(TSD_RENDER_CONTOUR_SHADED_RELIEF_MODE);
	   	break;
		case TSD_RENDER_CONTOUR_SHADED_RELIEF_MODE:
	   	set_TSD_render_mode(TSD_RENDER_SHADED_RELIEF_MODE);
	   	break;
		case TSD_RENDER_SHADED_RELIEF_MODE:
	   	set_TSD_render_mode(TSD_RENDER_CONTOUR_MODE);
	   	break;
	   default:
	      set_TSD_render_mode(TSD_RENDER_CONTOUR_MODE);
	}
	command_line_tsd_render_mode = tsd_render_mode-1;
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//VJ 030429 TSD render mod
static void TSD_render_palette_event (event *ev)
{
	cycle_tsd_map_palette();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//VJ 030318 wideview mod
//VJ 050213 bug fixes for pitch
static void toggle_wideview_event (event *ev)
{
	if (get_global_gunship_type () == GUNSHIP_TYPE_APACHE)
	{
		// wideview always enabled for apache
		set_global_wide_cockpit(TRUE);
		return;
	}

	set_global_wide_cockpit (get_global_wide_cockpit () ^ 1);
   edit_wide_cockpit = FALSE;
   //VJ 050211 restore pitch when switching of wideview
   if (!get_global_wide_cockpit ())
   {
		pilot_head_pitch_datum = 0;
		co_pilot_head_pitch_datum = 0;
		if (wide_cockpit_nr == WIDEVIEW_APACHE_PILOT ||
			 wide_cockpit_nr == WIDEVIEW_HAVOC_PILOT)
			pilot_head_pitch = 0;
	}
	else
	{
		if (wide_cockpit_nr == WIDEVIEW_APACHE_PILOT ||
			 wide_cockpit_nr == WIDEVIEW_HAVOC_PILOT)
		{
			pilot_head_pitch = rad ( wide_cockpit_position[wide_cockpit_nr].c.p );
			pilot_head_pitch_datum = rad ( wide_cockpit_position[wide_cockpit_nr].c.p );
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//VJ wideview mod, date: 18-mar-03
static void toggle_wideview_edit_event (event *ev)
{
//VJ 050126 save_wide no longer needed, this can toggle
	if (get_global_wide_cockpit ())
	{
		if (edit_wide_cockpit)
		   edit_wide_cockpit = FALSE;
		else
		   edit_wide_cockpit = TRUE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//
// special toggle for programmable joysticks:-
//
// APACHE	: toggle cockpit graphics
// HAVOC		: toggle cockpit graphics
// COMANCHE	: toggle glass cockpits
// HOKUM		: toggle glass cockpits
//

static void special_cockpit_toggle_event (event *ev)
{
	switch (get_global_gunship_type ())
	{
		// JB 030313 Fly any aircraft
		default:
		case GUNSHIP_TYPE_APACHE:
		case GUNSHIP_TYPE_HAVOC:
	////Moje 030521 Start
		case GUNSHIP_TYPE_BLACKHAWK:
	////Moje 030521 End
	////Moje 030612 start
		case GUNSHIP_TYPE_HIND:
	////Moje 030612 end
	////Moje 030816 Start
		case GUNSHIP_TYPE_AH64A:
		case GUNSHIP_TYPE_KA50:
	////Moje 030816 end
		{
			set_global_draw_cockpit_graphics (get_global_draw_cockpit_graphics () ^ 1);

			break;
		}
		case GUNSHIP_TYPE_COMANCHE:
		case GUNSHIP_TYPE_HOKUM:
		case GUNSHIP_TYPE_VIPER:
		case GUNSHIP_TYPE_KIOWA:
		{
 			set_global_glass_cockpit (get_global_glass_cockpit () ^ 1);

			break;
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void hokum_pilot_view1_event (event *ev)
{
	ASSERT (get_global_gunship_type () == GUNSHIP_TYPE_HOKUM);

	#define HEADING_OFFSET ((float) (rad (-3.5)))
	#define PITCH_OFFSET ((float) (rad (-2.5)))

	if (get_crew_role () == CREW_ROLE_PILOT)
	{
		if ((pilot_head_heading == HEADING_OFFSET) && (pilot_head_pitch == PITCH_OFFSET))
		{
			set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
		}
		else
		{
			set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);

			pilot_head_heading = HEADING_OFFSET;
			pilot_head_pitch = PITCH_OFFSET;
		}
	}

	#undef HEADING_OFFSET
	#undef PITCH_OFFSET
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void hokum_pilot_view2_event (event *ev)
{
	ASSERT (get_global_gunship_type () == GUNSHIP_TYPE_HOKUM);

	#define HEADING_OFFSET ((float) (rad (-10.1)))
	#define PITCH_OFFSET ((float) (rad (-19.0)))

	if (get_crew_role () == CREW_ROLE_PILOT)
	{
		if ((pilot_head_heading == HEADING_OFFSET) && (pilot_head_pitch == PITCH_OFFSET))
		{
			set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
		}
		else
		{
			set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);

			pilot_head_heading = HEADING_OFFSET;
			pilot_head_pitch = PITCH_OFFSET;
		}
	}

	#undef HEADING_OFFSET
	#undef PITCH_OFFSET
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void hokum_pilot_view3_event (event *ev)
{
	ASSERT (get_global_gunship_type () == GUNSHIP_TYPE_HOKUM);

	#define HEADING_OFFSET ((float) (rad (-25.0)))
	#define PITCH_OFFSET ((float) (rad (-21.0)))

	if (get_crew_role () == CREW_ROLE_PILOT)
	{
		if ((pilot_head_heading == HEADING_OFFSET) && (pilot_head_pitch == PITCH_OFFSET))
		{
			set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);
		}
		else
		{
			set_view_mode (VIEW_MODE_COCKPIT_PANEL_LEVEL_AHEAD);

			pilot_head_heading = HEADING_OFFSET;
			pilot_head_pitch = PITCH_OFFSET;
		}
	}

	#undef HEADING_OFFSET
	#undef PITCH_OFFSET
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// HI-RES SUPPORT
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void set_screen_resolution_status_message (void)
{
	char
		buffer[200];

	sprintf (buffer, "%dx%d", (int) get_global_3d_visual_screen_width (), (int) get_global_3d_visual_screen_height ());

	set_status_message (buffer, STATUS_MESSAGE_TYPE_NONE);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void set_default_3d_resolutions_event (event *ev)
{
	set_3d_resolutions (800.0, 600.0);

	set_screen_resolution_status_message ();

	if (get_gunship_entity ())
	{
		if (get_apache_havoc_gunship ())
		{
			set_global_draw_cockpit_graphics (TRUE);

			set_global_draw_overlaid_instruments (TRUE);

			if (in_cockpit)
			{
#if 0
				if (get_apache_havoc_gunship_fixed_cockpit ())
				{
					if (get_view_mode () == VIEW_MODE_VIRTUAL_COCKPIT)
					{
						set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));
					}
					else
					{
						set_view_mode (get_view_mode ());
					}
				}
				else
#endif
				{
					set_view_mode (get_view_mode ());
				}
			}
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void decrease_3d_resolutions_event (event *ev)
{
	decrease_3d_resolutions (NULL);

	set_screen_resolution_status_message ();

	if (get_gunship_entity ())
	{
		if (get_apache_havoc_gunship ())
		{
			if (in_cockpit)
			{
//VJ
/*
set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT);
             set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));
*/
#if 0
				if (get_apache_havoc_gunship_fixed_cockpit ())
				{
					if (get_view_mode () == VIEW_MODE_VIRTUAL_COCKPIT)
					{
						set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));
					}
					else
					{
						set_view_mode (get_view_mode ());
					}
				}
				else
#endif
				{
					set_view_mode (get_view_mode ());
				}
//*/
			}
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void increase_3d_resolutions_event (event *ev)
{
	increase_3d_resolutions (NULL);

	set_screen_resolution_status_message ();

	if (get_gunship_entity ())
	{
		if (get_apache_havoc_gunship ())
		{
			if (in_cockpit)
			{
//VJ
/*		set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT);
						set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));
		*/
#if 0
				if (get_apache_havoc_gunship_fixed_cockpit ())
				{
					if (get_view_mode () == VIEW_MODE_VIRTUAL_COCKPIT)
					{
						set_view_mode (get_nearest_fixed_cockpit_view (pilot_head_heading, pilot_head_pitch));
					}
					else
					{
						set_view_mode (get_view_mode ());
					}
				}
				else
#endif
				{
					set_view_mode (get_view_mode ());
				}
			}
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// SELECT OBJECT TO VIEW
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void next_side_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_next_side ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void previous_side_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_previous_side_event ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void next_category_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_next_category ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void previous_category_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_previous_category ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void next_type_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_next_type ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void previous_type_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_previous_type ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void next_object_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_next_object ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void previous_object_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_previous_object_event ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void players_gunship_event (event *ev)
{
	if (select_view_menu_view_players_gunship ())
	{
		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void players_target_event (event *ev)
{
	if (select_view_menu_view_players_target ())
	{
		select_external_view ();
	}
	else
	{
		entity
			*source,
			*target;

		source = get_gunship_entity ();

		if (source)
		{
			target = get_local_entity_parent (source, LIST_TYPE_TARGET);

			if (target)
			{
				if (get_local_entity_int_value (target, INT_TYPE_IDENTIFY_FIXED))
				{
					notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_BUILDING);

					reset_building_camera_values (target);
				}
			}
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void players_weapon_event (event *ev)
{
	if (select_view_menu_view_players_gunship ())
	{
		if (get_local_entity_viewable_weapon (get_gunship_entity ()))
		{
			select_external_view ();
		}

		notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_WEAPON);
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void players_padlock_event (event *ev)
{
	padlock_modes
		padlock_mode;

	padlock_mode = get_padlock_mode ();

	if (select_view_menu_view_players_padlock ())
	{
		select_external_view ();

		if (padlock_mode == PADLOCK_MODE_MISSILE_THREAT)
		{
			notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_WEAPON);
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void view_all_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_view_menu_view_all ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void view_wingmen_event (event *ev)
{
	if (select_view_menu_view_wingmen ())
	{
		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void view_players_event (event *ev)
{
	select_view_menu_view_players ();

	select_external_view ();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void view_available_gunships_event (event *ev)
{
	select_view_menu_view_available_gunships ();

	select_external_view ();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void next_view_range_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_next_view_menu_range ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void previous_view_range_event (event *ev)
{
	// Jabberwock 031009 Satellite view - keysites are not on menu

	if (get_local_entity_type(get_external_view_entity()) != ENTITY_TYPE_KEYSITE)
	{
		select_previous_view_menu_range ();

		select_external_view ();
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void key_up_event (event *ev)
{
	if (get_global_cyclic_input() == KEYBOARD_INPUT)
		cyclic_forward(ev);
	else if (get_view_mode() != VIEW_MODE_EXTERNAL)
	{
		if (ev->state == KEY_STATE_DOWN)
			adjust_pitch_trim(ev);
	}
	else
		move_view_position_forward_event(ev);
}

static void key_down_event (event *ev)
{
	if (get_global_cyclic_input() == KEYBOARD_INPUT)
		cyclic_backward(ev);
	else if (get_view_mode() != VIEW_MODE_EXTERNAL)
	{
		if (ev->state == KEY_STATE_DOWN)
			adjust_pitch_trim(ev);
	}
	else
		move_view_position_backward_event(ev);
}

static void key_left_event (event *ev)
{
	if (get_global_cyclic_input() == KEYBOARD_INPUT)
		cyclic_left(ev);
	else if (get_view_mode() != VIEW_MODE_EXTERNAL)
	{
		if (ev->state == KEY_STATE_DOWN)
			adjust_roll_trim(ev);
	}
	else
		move_view_position_left_event(ev);
}

static void key_right_event (event *ev)
{
	if (get_global_cyclic_input() == KEYBOARD_INPUT)
		cyclic_right(ev);
	else if (get_view_mode() != VIEW_MODE_EXTERNAL)
	{
		if (ev->state == KEY_STATE_DOWN)
			adjust_roll_trim(ev);
	}
	else
		move_view_position_right_event(ev);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// SELECT CAMERA
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void chase_camera_event (event *ev)
{
	switch (get_camera_mode(get_camera_entity()))
	{
	case CAMERA_MODE_CHASE:
	case CAMERA_MODE_WEAPON:
		notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_FREE);
		break;
	default:
		notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_CHASE);
		break;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void reset_chase_camera_position_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_RESET_CHASE_POSITION);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_chase_camera_lock_rotate_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_TOGGLE_CHASE_LOCK_ROTATE);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void fly_by_camera_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_FLY_BY);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void drop_camera_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_DROP);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void static_camera_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_STATIC);
}

// Jabberwock 031009 Satellite view

static void satellite_camera_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_SATELLITE);
}

// Jabberwock 031009 ends

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void weapon_camera_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_WEAPON);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void camera_auto_edit_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_AUTO_EDIT);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void cinematic_camera_event (event *ev)
{
	notify_local_entity (ENTITY_MESSAGE_SET_CAMERA_ACTION, get_camera_entity (), NULL, CAMERA_ACTION_CINEMATIC);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void crew_camera_event (event *ev)
{
	if (get_view_mode () != VIEW_MODE_VIRTUAL_COCKPIT_CREW)
	{
		set_view_mode (VIEW_MODE_VIRTUAL_COCKPIT_CREW);
	}
	else
	{
		select_next_current_virtual_cockpit_camera (get_crew_role ());
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// PADLOCK VIEWS
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void set_padlock_view_event (event *ev)
{
	ASSERT (ev);

	if (external_view_inset_target)
	{
		switch (ev->key)
		{
			////////////////////////////////////////
			case DIK_0:
			////////////////////////////////////////
			{
				select_inset_view_event (PADLOCK_MODE_NONE);

				break;
			}
			////////////////////////////////////////
			case DIK_2:
			////////////////////////////////////////
			{
				select_inset_view_event (PADLOCK_MODE_WINGMAN);

				break;
			}
			////////////////////////////////////////
			case DIK_3:
			////////////////////////////////////////
			{
				select_inset_view_event (PADLOCK_MODE_AIR_THREAT);

				break;
			}
			////////////////////////////////////////
			case DIK_4:
			////////////////////////////////////////
			{
				select_inset_view_event (PADLOCK_MODE_GROUND_THREAT);

				break;
			}
			////////////////////////////////////////
			case DIK_5:
			////////////////////////////////////////
			{
				select_inset_view_event (PADLOCK_MODE_MISSILE_THREAT);

				break;
			}
			////////////////////////////////////////
			case DIK_6:
			////////////////////////////////////////
			{
				select_inset_view_event (PADLOCK_MODE_WAYPOINT);

				break;
			}
		}
	}
	else
	{
		switch (ev->key)
		{
			////////////////////////////////////////
			case DIK_2:
			////////////////////////////////////////
			{
				select_padlock_view_event (PADLOCK_MODE_WINGMAN);

				break;
			}
			////////////////////////////////////////
			case DIK_3:
			////////////////////////////////////////
			{
				select_padlock_view_event (PADLOCK_MODE_AIR_THREAT);

				break;
			}
			////////////////////////////////////////
			case DIK_4:
			////////////////////////////////////////
			{
				select_padlock_view_event (PADLOCK_MODE_GROUND_THREAT);

				break;
			}
			////////////////////////////////////////
			case DIK_5:
			////////////////////////////////////////
			{
				select_padlock_view_event (PADLOCK_MODE_MISSILE_THREAT);

				break;
			}
			////////////////////////////////////////
			case DIK_6:
			////////////////////////////////////////
			{
				select_padlock_view_event (PADLOCK_MODE_WAYPOINT);

				break;
			}
			////////////////////////////////////////
			case DIK_0:
			////////////////////////////////////////
			{
				select_padlock_view_event (PADLOCK_MODE_NONE);

				break;
			}
		}
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// MISCELLANEOUS
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_view_menu_event (event *ev)
{
	if (get_outgoing_in_flight_message_flag ())
	{
		return;
	}

	if (in_cockpit)
	{
		set_view_menu_display_visible_status (TRUE);
	}
	else
	{
		if (get_view_menu_display_visible_status ())
		{
			set_view_menu_display_visible_status (FALSE);
		}
		else
		{
			set_view_menu_display_visible_status (TRUE);
		}
	}

	select_external_view ();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_object_text_event (event *ev)
{
	set_global_display_external_view_name (get_global_display_external_view_name () ^ 1);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_inset_target_event (event *ev)
{
	if (external_view_inset_target)
	{
		external_view_inset_target = FALSE;

		set_status_message (get_trans ("Inset target OFF"), STATUS_MESSAGE_TYPE_NONE);
	}
	else
	{
		external_view_inset_target = TRUE;

		set_status_message (get_trans ("Inset target ON"), STATUS_MESSAGE_TYPE_NONE);
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void toggle_display_in_flight_intelligence_messages_event (event *ev)
{
	if (get_global_display_in_flight_intelligence_messages ())
	{
		set_global_display_in_flight_intelligence_messages (FALSE);

		set_status_message (get_trans ("In-flight intelligence messages OFF"), STATUS_MESSAGE_TYPE_NONE);
	}
	else
	{
		set_global_display_in_flight_intelligence_messages (TRUE);

		set_status_message (get_trans ("In-flight intelligence messages ON"), STATUS_MESSAGE_TYPE_NONE);
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//	Retro 030317, 030318
//		Events to set Low/Med/Hi Field of View, and to recenter mouseview
static void lo_fov_event(event *ev)
{
	set_view_angles (rad (command_line_min_fov));
}
static void std_fov_event(event *ev)
{
	set_view_angles (rad (DEFAULT_FOV));
}
static void hi_fov_event(event *ev)
{
	// Casm 08OCT05 Max fov depends on gunship type
	set_view_angles ( rad (get_max_fov ()) );
}

static void increase_fov_event(event* ev)
{
	increase_fov_key_down = (ev->state == KEY_STATE_DOWN);
}

static void decrease_fov_event(event* ev)
{
	decrease_fov_key_down = (ev->state == KEY_STATE_DOWN);
}

static void reset_mouse_event(event* ev)
{
	reset_absolute_mouse ();
}
//(end Retro)

// Casm 18DEC15 Skin
static void advance_skin (event *ev)
{
	helicopter
		*raw;

	raw = (helicopter *) get_local_entity_data (get_gunship_entity ());
	skin_next (raw->ac.inst3d);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// SET EVENTS
//
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_view_mode_events (void)
{
	////////////////////////////////////////
	//
	// pan
	//
	////////////////////////////////////////

	set_event (DIK_LEFT, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_left_event);
	set_event (DIK_RIGHT, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_right_event);
	set_event (DIK_UP, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_up_event);
	set_event (DIK_DOWN, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_down_event);

	////////////////////////////////////////
	//
	// zoom
	//
	////////////////////////////////////////

	set_event (DIK_PERIOD, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_zoom_in_event);
	set_event (DIK_COMMA, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_zoom_out_event);

	////////////////////////////////////////
	//
	// move
	//
	////////////////////////////////////////

	set_event (DIK_LEFT, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, key_left_event);
	set_event (DIK_RIGHT, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, key_right_event);
	set_event (DIK_UP, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, key_up_event);
	set_event (DIK_DOWN, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, key_down_event);
	set_event (DIK_LEFT, MODIFIER_NONE, KEY_STATE_EITHER, key_left_event);
	set_event (DIK_RIGHT, MODIFIER_NONE, KEY_STATE_EITHER, key_right_event);
	set_event (DIK_UP, MODIFIER_NONE, KEY_STATE_EITHER, key_up_event);
	set_event (DIK_DOWN, MODIFIER_NONE, KEY_STATE_EITHER, key_down_event);

	////////////////////////////////////////
	//
	// hi-res support
	//
	////////////////////////////////////////

	set_event (DIK_F1, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, set_default_3d_resolutions_event);

	set_event (DIK_F3, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, decrease_3d_resolutions_event);

	set_event (DIK_F4, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, increase_3d_resolutions_event);
	////////////////////////////////////////
	//
	// select object to view
	//
	////////////////////////////////////////

	set_event (DIK_F5, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, next_side_event);
	set_event (DIK_F5, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, previous_side_event);
	set_event (DIK_F5, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, view_all_event);

	set_event (DIK_F6, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, next_category_event);
	set_event (DIK_F6, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, previous_category_event);

	set_event (DIK_F7, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, next_type_event);
	set_event (DIK_F7, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, previous_type_event);
	set_event (DIK_F7, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, view_players_event);

	set_event (DIK_F8, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, next_object_event);
	set_event (DIK_F8, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, previous_object_event);

	if (get_game_type () != GAME_TYPE_DEMO)
	{
		set_event (DIK_F8, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, view_available_gunships_event);
	}

	////////////////////////////////////////
	//
	// select camera
	//
	////////////////////////////////////////

	set_event (DIK_F9, MODIFIER_NONE, KEY_STATE_DOWN, chase_camera_event);
	set_event (DIK_F9, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, reset_chase_camera_position_event);
	set_event (DIK_F9, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, toggle_chase_camera_lock_rotate_event);
	set_event (DIK_F9, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, satellite_camera_event); // Jabberwock 031009 Satellite view

	set_event (DIK_F10, MODIFIER_NONE, KEY_STATE_DOWN, fly_by_camera_event);
	set_event (DIK_F10, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, drop_camera_event);
	set_event (DIK_F10, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, static_camera_event);
	set_event (DIK_F10, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, weapon_camera_event);

	set_event (DIK_F11, MODIFIER_NONE, KEY_STATE_DOWN, camera_auto_edit_event);
	set_event (DIK_F11, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, cinematic_camera_event);
	set_event (DIK_F11, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, set_next_mfd_size_event);

	////////////////////////////////////////
	//
	// miscellaneous
	//
	////////////////////////////////////////

	set_event (DIK_F12, MODIFIER_NONE, KEY_STATE_DOWN, toggle_view_menu_event);
	set_event (DIK_F12, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, toggle_object_text_event);
	set_event (DIK_F12, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, toggle_inset_target_event);

	set_event (DIK_I, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, toggle_display_in_flight_intelligence_messages_event);

	// Retro 030317 start
	// see above
	set_event (DIK_7, MODIFIER_NONE, KEY_STATE_DOWN, lo_fov_event);
	set_event (DIK_8, MODIFIER_NONE, KEY_STATE_DOWN, std_fov_event);
	set_event (DIK_9, MODIFIER_NONE, KEY_STATE_DOWN, hi_fov_event);

	set_event (MOUSE_LEFT_BUTTON, MODIFIER_NONE, BUTTON_STATE_EITHER, reset_mouse_event);
	// Retro 030317 end

	set_event(DIK_D, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, TSD_render_event);
	//VJ 020423 TSD render mod
	set_event(DIK_D, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, TSD_render_palette_event);
	//VJ 020429 TSD render mod
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_demo_view_mode_events (void)
{
	set_view_mode_events ();
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void set_gunship_view_mode_events (void)
{
	ASSERT (get_gunship_entity ());

	////////////////////////////////////////
	//
	// pan
	//
	////////////////////////////////////////

	if (get_apache_havoc_gunship ())
	{
		set_event (DIK_LEFT, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_left_event);
		set_event (DIK_RIGHT, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_right_event);
		set_event (DIK_UP, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_up_event);
		set_event (DIK_DOWN, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_down_event);
/*
		set_event (DIK_LEFT, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, look_abs_left_event);
		set_event (DIK_RIGHT, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, look_abs_right_event);
		set_event (DIK_UP, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, look_abs_up_event);
		set_event (DIK_DOWN, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, look_abs_down_event);
*/
	}

	set_event (DIK_LALT, MODIFIER_LEFT_CONTROL, KEY_STATE_UP, release_virtual_cockpit_event);

	////////////////////////////////////////
	//
	// main cockpit views
	//
	////////////////////////////////////////

	set_event (DIK_F1, MODIFIER_NONE, KEY_STATE_DOWN, forward_view_event);
	set_event (DIK_F1, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, toggle_draw_cockpit_graphics_event);
	set_event (DIK_F1, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, toggle_unscaled_displays_event);

	set_event (DIK_F2, MODIFIER_NONE, KEY_STATE_DOWN, instrument_view_event);
	set_event (DIK_F2, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, toggle_display_hud_on_external_view_event);

	if (get_apache_havoc_gunship ())
	{
		set_event (DIK_F2, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, toggle_draw_overlaid_instruments_event);
	}
	else
	{
		set_event (DIK_F2, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, toggle_glass_cockpit_event);

		set_event (DIK_F2, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, hud_view_event);

		set_event (DIK_F3, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, decrease_cockpit_detail_event);
		set_event (DIK_F4, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, increase_cockpit_detail_event);
	}

	set_event (DIK_F3, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, decrease_fov_event);
	set_event (DIK_F4, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, increase_fov_event);
	set_event (DIK_F3, MODIFIER_NONE, KEY_STATE_UP, decrease_fov_event);
	set_event (DIK_F4, MODIFIER_NONE, KEY_STATE_UP, increase_fov_event);

	set_event (DIK_F3, MODIFIER_NONE, KEY_STATE_DOWN, look_at_special1_event);
	set_event (DIK_F4, MODIFIER_NONE, KEY_STATE_DOWN, look_at_special2_event);

	if (get_comanche_hokum_gunship ())
	{
		set_event (DIK_LEFT, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_abs_left_event);
		set_event (DIK_RIGHT, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_abs_right_event);
		set_event (DIK_UP, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, forward_view_event);
		set_event (DIK_DOWN, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, instrument_view_event);

/*
		set_event (DIK_LEFT, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, look_at_special1_event);
		set_event (DIK_RIGHT, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, look_at_special2_event);
		set_event (DIK_UP, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, set_pilot_seat_position_event);
		set_event (DIK_DOWN, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, set_co_pilot_seat_position_event);
*/
	}

	if (get_comanche_hokum_gunship () && get_global_gunship_type () != GUNSHIP_TYPE_KA50 && get_global_gunship_type () != GUNSHIP_TYPE_HIND)
	{
		set_event (DIK_ESCAPE, MODIFIER_NONE, KEY_STATE_DOWN, switch_seat_position_event);
	}

	set_event (DIK_0, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, special_cockpit_toggle_event);

//VJ wideview mod, date: 18-mar-03
	set_event (DIK_BACKSLASH, MODIFIER_NONE, KEY_STATE_DOWN, toggle_wideview_event);
	set_event (DIK_BACKSLASH, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, toggle_wideview_edit_event);

	if (get_global_gunship_type () == GUNSHIP_TYPE_HOKUM)
	{
		set_event (DIK_DELETE, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, hokum_pilot_view1_event);
		set_event (DIK_END, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, hokum_pilot_view2_event);
		set_event (DIK_NEXT, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, hokum_pilot_view3_event);

		set_event (DIK_V, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, hokum_pilot_view1_event);
		set_event (DIK_B, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, hokum_pilot_view2_event);
		set_event (DIK_N, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, hokum_pilot_view3_event);
	}

	////////////////////////////////////////
	//
	// select object to view
	//
	////////////////////////////////////////

	set_event (DIK_F5, MODIFIER_NONE, KEY_STATE_DOWN, players_gunship_event);

	set_event (DIK_F6, MODIFIER_NONE, KEY_STATE_DOWN, players_target_event);
	set_event (DIK_F6, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, view_wingmen_event);

	set_event (DIK_F7, MODIFIER_NONE, KEY_STATE_DOWN, players_weapon_event);

	set_event (DIK_F8, MODIFIER_NONE, KEY_STATE_DOWN, players_padlock_event);

	set_event (DIK_EQUALS, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, next_view_range_event);
	set_event (DIK_MINUS, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, previous_view_range_event);

	set_event (DIK_NUMPADPLUS, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, next_view_range_event);
	set_event (DIK_NUMPADMINUS, MODIFIER_LEFT_ALT, KEY_STATE_DOWN, previous_view_range_event);

	////////////////////////////////////////
	//
	// select camera
	//
	////////////////////////////////////////

	if (get_comanche_hokum_gunship ())
	{
		set_event (DIK_F11, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, crew_camera_event);
	}

	////////////////////////////////////////
	//
	// padlock views
	//
	////////////////////////////////////////

	set_event (DIK_2, MODIFIER_NONE, KEY_STATE_DOWN, set_padlock_view_event);
	set_event (DIK_3, MODIFIER_NONE, KEY_STATE_DOWN, set_padlock_view_event);
	set_event (DIK_4, MODIFIER_NONE, KEY_STATE_DOWN, set_padlock_view_event);
	set_event (DIK_5, MODIFIER_NONE, KEY_STATE_DOWN, set_padlock_view_event);
	set_event (DIK_6, MODIFIER_NONE, KEY_STATE_DOWN, set_padlock_view_event);
	set_event (DIK_0, MODIFIER_NONE, KEY_STATE_DOWN, set_padlock_view_event);

	// Casm 18DEC15 Skin
	set_event (DIK_SCROLL, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, advance_skin);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

static void set_numpad_cockpit_view_events (void)
{
	if (get_apache_havoc_gunship ())
	{
		set_event (DIK_NUMPAD4, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_left_event);
		set_event (DIK_NUMPAD6, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_right_event);
		set_event (DIK_NUMPAD8, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_up_event);
		set_event (DIK_NUMPAD2, MODIFIER_LEFT_CONTROL, KEY_STATE_DOWN, look_rel_down_event);

		set_event (DIK_NUMPAD4, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, look_abs_left_event);
		set_event (DIK_NUMPAD6, MODIFIER_LEFT_SHIFT, KEY_STATE_DOWN, look_abs_right_event);
		set_event (DIK_NUMPAD8, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, look_abs_up_event);
		set_event (DIK_NUMPAD2, MODIFIER_LEFT_SHIFT, KEY_STATE_EITHER, look_abs_down_event);
	}

	set_event (DIK_NUMPAD4, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_left_event);
	set_event (DIK_NUMPAD6, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_right_event);
	set_event (DIK_NUMPAD8, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_up_event);
	set_event (DIK_NUMPAD2, MODIFIER_LEFT_ALT, KEY_STATE_EITHER, adjust_view_down_event);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void push_numpad_cockpit_view_events_overlay (void)
{
	stop_messaging_system (NULL);

	if (get_event_stack_head_function () == ingame_screen_set_events)
	{
		ASSERT (get_in_flight_game_mode () == IN_FLIGHT_GAME_MODE_PLANNER);

		pop_event (ingame_screen_set_events);

		push_event_overlay (set_numpad_cockpit_view_events, "numpad cockpit view events");

		push_event (ingame_screen_set_events, "ingame screen events");
	}
	else
	{
		ASSERT (get_in_flight_game_mode () == IN_FLIGHT_GAME_MODE_SIMULATOR);

		push_event_overlay (set_numpad_cockpit_view_events, "numpad cockpit view events");
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void pop_numpad_cockpit_view_events_overlay (void)
{
	pop_event (set_numpad_cockpit_view_events);
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

void update_joystick_pov_position (void)
{
#ifndef OGRE_EE
	joystick_hat_position
		joystick_pov_position;

	int
		previous_joystick_pov_centred;

	previous_joystick_pov_centred = joystick_pov_centred;
#endif

	joystick_pov_engage = FALSE;

	joystick_pov_disengage = FALSE;

	joystick_pov_centred = FALSE;

	joystick_pov_left = FALSE;

	joystick_pov_right = FALSE;

	joystick_pov_up = FALSE;

	joystick_pov_down = FALSE;

#ifndef OGRE_EE
	if (get_global_cyclic_input () == JOYSTICK_INPUT)
	{
#ifdef WIN32
// Retro_dead_18Jul2004		if (joystick_devices[global_options.joystick_device_index].joystick_has_pov)
		if (joystick_devices[command_line_cyclic_joystick_index].joystick_has_pov)
#else
// Retro_dead_18Jul2004		if (joystick_devices[global_options.joystick_device_index].number_of_hats > 0)
		if (joystick_devices[command_line_cyclic_joystick_index].number_of_hats > 0)
#endif
		{
// Retro_dead_18Jul2004			joystick_pov_position = get_joystick_hat( &joystick_devices[global_options.joystick_device_index], 0 );
			joystick_pov_position = get_joystick_hat( &joystick_devices[command_line_cyclic_joystick_index], 0 );

			switch(joystick_pov_position) {
			case HAT_CENTERED:
				joystick_pov_centred = TRUE;
				break;
			case HAT_UP:
				joystick_pov_up = TRUE;
				break;
			case HAT_RIGHT:
				joystick_pov_right = TRUE;
				break;
			case HAT_DOWN:
				joystick_pov_down = TRUE;
				break;
			case HAT_LEFT:
				joystick_pov_left = TRUE;
				break;
			default:
				joystick_pov_up = TRUE;
			}

			if (previous_joystick_pov_centred)
			{
				if (!joystick_pov_centred)
				{
					joystick_pov_engage = TRUE;
				}
			}
			else
			{
				if (joystick_pov_centred)
				{
					joystick_pov_disengage = TRUE;
				}
			}
		}
		else
		{
			joystick_pov_centred = TRUE;
		}
	}
	else
#endif
	{
		joystick_pov_centred = TRUE;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
